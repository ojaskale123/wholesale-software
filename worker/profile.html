<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>My Profile</title>

<style>
  * {
    box-sizing: border-box;
    font-family: Segoe UI, Arial, sans-serif;
  }

  body {
    margin: 0;
    background: linear-gradient(180deg,#eef2f3,#dfe6e9);
  }

  /* HEADER */
  .app-header {
    background: linear-gradient(90deg,#0f2027,#203a43,#2c5364);
    color: white;
    padding: 16px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    box-shadow: 0 4px 12px rgba(0,0,0,.35);
  }

  .header-btn {
    background: rgba(255,255,255,0.15);
    border: none;
    color: white;
    padding: 6px 12px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
  }

  .container {
    padding: 35px 20px;
    display: flex;
    justify-content: center;
  }

  .card {
    background: white;
    width: 100%;
    max-width: 420px;
    border-radius: 22px;
    padding: 30px;
    box-shadow: 0 18px 40px rgba(0,0,0,.2);
    animation: fade .4s ease;
  }

  @keyframes fade {
    from { opacity: 0; transform: translateY(10px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .avatar {
    width: 90px;
    height: 90px;
    border-radius: 50%;
    background: linear-gradient(135deg,#667eea,#764ba2);
    color: white;
    font-size: 38px;
    font-weight: bold;
    display: flex;
    align-items: center;
    justify-content: center;
    margin: 0 auto 16px;
  }

  h3 {
    text-align: center;
    margin: 8px 0 4px;
  }

  .role {
    text-align: center;
    font-size: 13px;
    color: #777;
    margin-bottom: 22px;
  }

  .row {
    margin-bottom: 14px;
    font-size: 14px;
  }

  .row b {
    color: #203a43;
  }

  .logout {
    margin-top: 20px;
    width: 100%;
    padding: 14px;
    border: none;
    border-radius: 14px;
    font-size: 15px;
    font-weight: bold;
    cursor: pointer;
    background: linear-gradient(135deg,#e74c3c,#c0392b);
    color: white;
    transition: transform .15s ease, box-shadow .15s ease;
  }

  .logout:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 20px rgba(0,0,0,.25);
  }
</style>
</head>

<body>

<header class="app-header">
  <button class="header-btn" onclick="location.href='index.html'">â¬… Back</button>
  <h2>My Profile</h2>
  <span></span>
</header>

<div class="container">
  <div class="card">

    <div class="avatar" id="avatar"></div>

    <h3 id="name"></h3>
    <div class="role" id="role"></div>

    <div class="row"><b>Phone:</b> <span id="phone"></span></div>
    <div class="row"><b>Shop:</b> <span id="shop"></span></div>
    <div class="row"><b>User ID:</b> <span id="uid"></span></div>

    <button class="logout" onclick="logout()">LOG OUT</button>

  </div>
</div>

<script type="module">
import { requireAuth } from "../auth/guard.js";
import { DB } from "../db/fakeDB.js";

/* AUTH */
const user = requireAuth(["WORKER"]);

/* DATA */
name.innerText = user.name || "Worker";
role.innerText = user.role;
phone.innerText = user.phone || "-";
uid.innerText = user.id;

const shopObj = DB.shops.find(s => s.id === user.shopId);
shop.innerText = shopObj?.name || "-";

/* AVATAR */
avatar.innerText = (user.name || "W")[0].toUpperCase();

/* LOGOUT */
window.logout = () => {
  localStorage.removeItem("currentUser");
  location.href = "/login.html";
};
</script>

</body>
</html>
